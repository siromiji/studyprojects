<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>타자기 텍스트 애니메이션</title>
  <style>
    :root {
      --w: 720px;
    }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif; margin: 40px 20px; display:grid; place-items: center; background:#f6f7fb; }
    .app { width: min(var(--w), 92vw); background:#fff; border:1px solid #eaeaea; border-radius: 16px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,.06); }
    h1 { margin: 0 0 12px; font-size: 22px; }
    .desc { color:#666; font-size:14px; margin-bottom:16px; }

    .stage { 
      min-height: 120px; 
      border:1px dashed #ddd; 
      border-radius: 12px; 
      padding: 20px; 
      display:flex; 
      align-items:center; 
      justify-content:center; 
      font-size: 28px; 
      line-height: 1.3; 
      text-align: center; 
      position: relative; 
    }

    .cursor { display:inline-block; width: .6ch; margin-left:2px; background:#111; animation: blink 1s steps(1) infinite; }
    @keyframes blink { 50% { opacity: 0; } }

    .row { display:flex; flex-wrap:wrap; gap:10px; margin-top:16px; align-items:center; }
    .row label { font-size: 14px; color:#444; }
    .row input[type="range"] { width: 200px; }
    .pill { padding:6px 10px; border:1px solid #ddd; border-radius: 999px; font-size:13px; }
    .btn { padding:8px 12px; border:1px solid #ddd; background:#111; color:#fff; border-radius:10px; cursor:pointer; }
    .btn.light { background:#fff; color:#111; }
    .grow { flex:1; }
    textarea { width:100%; height:90px; padding:10px; border:1px solid #e5e7eb; border-radius:10px; resize:vertical; font-size:14px; }
    small { color:#777; }
  </style>
</head>
<body>
  <div class="app">
    <h1>타자기 텍스트 애니메이션 ✨</h1>
    <p class="desc">아래 문장을 한 글자씩 타이핑하고, 끝나면 지웠다가 다음 문장으로 넘어가요. (수정하고 ▶ 재생!)</p>

    <div class="stage">
      <span id="output"></span><span class="cursor" id="cursor">&nbsp;</span>
    </div>

    <div class="row">
      <label>속도: <input id="speed" type="range" min="20" max="200" value="80"> <span class="pill" id="speedVal">80 ms/글자</span></label>
      <label>정지시간: <input id="pause" type="range" min="300" max="2000" step="100" value="800"> <span class="pill" id="pauseVal">800 ms</span></label>
      <button class="btn" id="play">▶ 재생</button>
      <button class="btn light" id="stop">■ 정지</button>
    </div>

    <div class="row" style="margin-top:14px;">
      <div class="grow">
        <label for="lines"><strong>문장들 (줄바꿈으로 구분)</strong></label>
        <textarea id="lines">안녕 미지! 자바스크립트 재밌게 하자 :)
타자기 효과는 생각보다 간단해.
속도도 바꾸고, 문장도 네 마음대로!</textarea>
        <small>Tip: 각 줄이 한 문장이에요. 엔터로 문장을 추가/삭제하세요.</small>
      </div>
    </div>
  </div>

  <script>
    const output = document.getElementById('output');
    const cursor = document.getElementById('cursor');
    const speed = document.getElementById('speed');
    const pause = document.getElementById('pause');
    const speedVal = document.getElementById('speedVal');
    const pauseVal = document.getElementById('pauseVal');
    const playBtn = document.getElementById('play');
    const stopBtn = document.getElementById('stop');
    const linesEl = document.getElementById('lines');

    let timer = null;      // setTimeout 핸들
    let playing = false;   // 재생 중 여부

    function getLines(){
      return linesEl.value
        .split(/\n+/)
        .map(s => s.trim())
        .filter(Boolean);
    }

    function typeLoop(texts, idx = 0){
      if (!playing) return;
      const text = texts[idx % texts.length];
      let i = 0;

      const type = () => {
        if (!playing) return;
        if (i <= text.length) {
          output.textContent = text.slice(0, i);
          i++;
          timer = setTimeout(type, Number(speed.value));
        } else {
          // 다 쳤으면 잠깐 멈췄다가 지우기 시작
          timer = setTimeout(backspace, Number(pause.value));
        }
      };

      const backspace = () => {
        if (!playing) return;
        if (i >= 0) {
          output.textContent = text.slice(0, i);
          i--;
          timer = setTimeout(backspace, Number(speed.value) * 0.6); // 지우기는 약간 빠르게
        } else {
          // 다음 문장으로
          timer = setTimeout(() => typeLoop(texts, idx + 1), 200);
        }
      };

      type();
    }

    function play(){
      clearTimeout(timer);
      playing = true;
      cursor.style.opacity = 1; // 커서 보이기
      typeLoop(getLines());
    }

    function stop(){
      playing = false;
      clearTimeout(timer);
      cursor.style.opacity = 0.2; // 커서 연하게
    }

    // UI 연동
    speed.addEventListener('input', () => speedVal.textContent = `${speed.value} ms/글자`);
    pause.addEventListener('input', () => pauseVal.textContent = `${pause.value} ms`);
    playBtn.addEventListener('click', play);
    stopBtn.addEventListener('click', stop);

    // 처음 값 표시
    speed.dispatchEvent(new Event('input'));
    pause.dispatchEvent(new Event('input'));

    // 자동 재생 시작
    play();
  </script>
</body>
</html>
